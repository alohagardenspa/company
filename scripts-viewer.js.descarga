"use strict";angular.module("schedulerWidgetAppConstants",[]),angular.module("wixSdkUtilInternal",["wix","schedulerWidgetAppConstants"]),angular.module("widgetBiLogger",["wix.common.bi"]),angular.module("widgetPreload",[]),angular.module("widgetCommon",["schedulerWidgetAppConstants","wixSdkUtilInternal","widgetBiLogger","widgetPreload"]).config(["$compileProvider",function(a){a.preAssignBindingsEnabled(!0)}]),angular.module("serviceWidgetViewerInternal",["widgetCommon","schedulerWidgetAppConstants","schedulerCommonStatics","widgetTranslations","wix","wixAngular","wix.common.bi","widgetBiLogger","widgetPreload"]).config(["widgetBILoggerProvider","appViewerEventMap",function(a,b){a.setWixBiLoggerConfigInViewer(b,"wixboost-ugc")}]),angular.module("serviceWidgetViewer",["serviceWidgetViewerInternal","fedops"]).config(["fedopsLoggerProvider",function(a){a.setAppName("scheduler-widget")}]).run(["$$testability","$wix",function(a,b){a.whenStable(function(){b.Performance.applicationLoaded()})}]);try{angular.module("widgetTranslations")}catch(e){angular.module("widgetTranslations",["pascalprecht.translate"])}var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Service=function(){function a(a){Object.assign(this,a)}return a}();Service.DUMMY="DUMMY",Service.PRIVATE="PRIVATE",Service.GROUP="GROUP";var DummyServiceVO=function(a){function b(b){var c=a.call(this,b)||this;return c.id="-1",c.type=Service.DUMMY,c}return __extends(b,a),b}(Service),GroupServiceVO=function(a){function b(b){var c=a.call(this,b)||this;return c.type=Service.GROUP,c}return __extends(b,a),b.prototype.getTranslatedActiveDays=function(a,b){void 0===b&&(b=!1);var c=[];return this.classHours?(c=Object.keys(this.classHours).map(this.daysOfWeek(this)).filter(this.activeDaysOfWeek()),b||this.isFullTranslationForActiveDayRequired(c.length)?c.map(this.translateActiveDayWithPrefix(a,"week-day.")):c.map(this.translateActiveDayWithPrefix(a,"short-week-day."))):c},b.prototype.isFullTranslationForActiveDayRequired=function(a){return 1===a},b.prototype.translateActiveDayWithPrefix=function(a,b){return function(c){var d=c.dayOfWeek;return a(b+d)}},b.prototype.activeDaysOfWeek=function(){var a=this;return function(b){var c=b.dayOfWeekData;return a.isActiveDay(c)}},b.prototype.daysOfWeek=function(a){return function(b){return{dayOfWeek:b,dayOfWeekData:a.classHours[b]}}},b.prototype.isActiveDay=function(a){return!!a&&a.workingHours&&a.workingHours.length>0},b}(Service),PrivateServiceVO=function(a){function b(b){var c=a.call(this,b)||this;return c.type=Service.PRIVATE,c}return __extends(b,a),b}(Service),WidgetNavigateSrv=function(){function a(a){this.$wix=a,this.INDIVIDUAL_WIDGET_URL_PREFIX="individual",this.GROUP_WIDGET_URL_PREFIX="group"}return a.$inject=["$wix"],a.prototype.navigateToIndividual=function(a){this.navigateToApp(this.INDIVIDUAL_WIDGET_URL_PREFIX,a.id)},a.prototype.navigateToGroup=function(a){this.navigateToApp(this.GROUP_WIDGET_URL_PREFIX,a.id)},a.prototype.navigateToApp=function(a,b){var c={};c[WidgetDeepLinkConst.SERVICE_TYPE]=a,c[WidgetDeepLinkConst.SERVICE_ID]=b,c.timestamp=(new Date).getTime(),this.$wix.PubSub.publish(WidgetDeepLinkConst.DEEP_LINK,c,!0),this.$wix.Utils.navigateToSection()},a}();angular.module("serviceWidgetViewerInternal").service("widgetNavigateSrv",WidgetNavigateSrv);var BoostInjectionPersister=function(){function a(a){this.provider=a}return a.$inject=["provider"],a.prototype.getPrivateServices=function(){return this.provider.privateList},a.prototype.getGroupServices=function(){return this.provider.groupsList},a.prototype.getSelectedServices=function(){return this.provider.selectedServicesList},a}(),BoostInjectionPersisterProvider=function(){function a(){}return a.prototype.setPrivateServices=function(a){this.privateList=angular.fromJson(a)},a.prototype.setGroupServices=function(a){this.groupsList=angular.fromJson(a)},a.prototype.setSelectedServices=function(a){this.selectedServicesList=angular.fromJson(a)},a.prototype.$get=function(a){return a.instantiate(BoostInjectionPersister,{provider:this})},a.prototype.$get.$inject=["$injector"],a}();angular.module("widgetCommon").provider("boostInjectionPersister",BoostInjectionPersisterProvider);var ServiceSettingsVO=function(){function a(a){angular.extend(this,a)}return a}(),SettingsPersistence=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$wix=a,this.SERVICE_TEMPLATE=b,this.TILE_IMAGE_SHAPE=c,this.TILE_BUTTON_STYLE=d,this.TILE_CARD_TEXT_ALIGNMENT=e,this.$q=f,this.settingsToViewerNotifier=g,this.browserPersistent=h,this.storageConst=i,this.$window=j,this.$rootScope=k,this.eventsConst=l}return a.$inject=["$wix","SERVICE_TEMPLATE","TILE_IMAGE_SHAPE","TILE_BUTTON_STYLE","TILE_CARD_TEXT_ALIGNMENT","$q","settingsToViewerNotifier","browserPersistent","storageConst","$window","$rootScope","eventsConst"],a.prototype.gettingValueByKey=function(a){var b=this.$q.defer();return this.$wix.Data.Public.get(a,function(c){b.resolve(c[a])},function(a){b.resolve("")}),b.promise},a.prototype.updateSettings=function(a,b){var c=this;return this.settingSettings(a,b).then(function(a){return c.$rootScope.$broadcast(c.eventsConst.LAYOUT_CHANGE),c.settingsToViewerNotifier.notifyLayoutChange(),a})},a.prototype.settingColorParam=function(a,b){var c=this.$q.defer();return this.$wix.Styles.setColorParam(a,b,function(){c.resolve(b)}),c.promise},a.prototype.settingFontStyleParam=function(a,b){var c=this.$q.defer();return this.$wix.Styles.setFontParam(a,{value:b},function(){c.resolve(b)}),c.promise},a.prototype.settingSliderParam=function(a,b){var c=this.$q.defer();return this.$wix.Styles.setNumberParam(a,b,function(){c.resolve(b)}),c.promise},a.prototype.settingSettings=function(a,b){var c=this.$q.defer();return b=b.value?b.value:b,this.$wix.Data.Public.set(a,b,function(b){null!==b[a]?c.resolve(b[a]):c.reject()},function(){c.reject()}),c.promise},a.prototype.removingSetting=function(a){var b=this.$q.defer();return this.$wix.Data.Public.remove(a,function(a){b.resolve(a)},function(){b.resolve(a)}),b.promise},a.prototype.gettingSettings=function(){var a=this,b=this.$q.defer(),c=this.getDefaultSettings(),d=Object.keys(c),e={};return d.forEach(function(b){e[b]=a.gettingValueByKey(b)}),this.$q.all(e).then(function(a){d.forEach(function(b){c[b]=""!==a[b]?a[b]:c[b]}),b.resolve(c)})["catch"](function(){b.resolve(a.createDefaultSettings())}),b.promise},a.prototype.createDefaultSettings=function(){var a={};return a.displayServiceName=!0,a.displayServicePrice=!0,a.displayServiceDuration=!0,a.displayServiceDescription=!0,a.displayServiceDays=!0,a.layoutPreset=this.SERVICE_TEMPLATE.HEIDI,a.imageType=this.TILE_IMAGE_SHAPE.SQUARE,a.cardTextAlignment=this.TILE_CARD_TEXT_ALIGNMENT.CENTER,a.buttonStyle=this.TILE_BUTTON_STYLE.FULL,a.buttonText="",a},a.prototype.getDefaultSettings=function(){return new ServiceSettingsVO(this.createDefaultSettings())},a.prototype.setWidgetSettingsShown=function(){try{this.browserPersistent.setItem(this.storageConst.WIDGET_SETTINGS_SHOWN,"true")}catch(a){this.$window.console.log("local storage is not available")}},a.prototype.isWidgetSettingsShown=function(){try{return"true"===this.browserPersistent.getItem(this.storageConst.WIDGET_SETTINGS_SHOWN)}catch(a){return!1}},a.prototype.resetSettings=function(){var a=new ResetSettings(this,this.$wix,this.$q);return a.invoke()},a}();angular.module("widgetCommon").service("settingsPersistence",SettingsPersistence);var ResetSettings=function(){function a(a,b,c){this.settingsPersistence=a,this.$wix=b,this.$q=c}return a.prototype.invoke=function(){var a=this;return this.resetColors().then(function(){return a.resetFonts()}).then(function(){return a.resetSliders()}).then(function(){return a.resetDataParams()})},a.prototype.resetColors=function(){var a=this,b=this.$wix.Styles.getSiteColors();return this.settingsPersistence.settingColorParam("widgetColorButtonText",b[5]).then(function(){return a.settingsPersistence.settingColorParam("widgetColorButtonBackground",b[12])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorFullButtonText",b[5])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorDescriptionHover",b[5])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorBorderButtonText",b[9])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorLinkButtonText",b[12])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorFullButtonBackground",b[12])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorBorderButtonBackground",b[5])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorButtonBorder",b[9])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorServiceDetails",b[9])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorServiceTitle",b[9])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorCardBackground",b[5])}).then(function(){return a.settingsPersistence.settingColorParam("widgetColorCardBackgroundBorder",b[5])})},a.prototype.resetFonts=function(){var a=this;return this.settingsPersistence.settingFontStyleParam("widgetFontServiceDetails","Body-M").then(function(){return a.settingsPersistence.settingFontStyleParam("widgetFontButton","Body-M")}).then(function(){return a.settingsPersistence.settingFontStyleParam("widgetFontDescription","Heading-S")}).then(function(){return a.settingsPersistence.settingFontStyleParam("widgetFontServiceTitle","Heading-S")})},a.prototype.resetSliders=function(){var a=this;return this.settingsPersistence.settingSliderParam("widgetBorderButtonWidth",0).then(function(){return a.settingsPersistence.settingSliderParam("widgetBorderRadiusButton",0)}).then(function(){return a.settingsPersistence.settingSliderParam("widgetBorderCardBackgroundWidth",0)})},a.prototype.resetDataParams=function(){var a=this.settingsPersistence.createDefaultSettings();return this.resetDataArray(Object.keys(a))},a.prototype.resetDataArray=function(a){var b=this;if(a.length>0){var c=a.pop();return this.settingsPersistence.removingSetting(c).then(function(){return b.resetDataArray(a)})}this.$q.when(null)},a}(),ServicesSrv=function(){function a(a,b,c){this.boostInjectionPersister=a,this.$wix=b,this.$translate=c,this.selectedServicesIds=this.boostInjectionPersister.getSelectedServices(),this.groups=this.initiateGroups(),this.privates=this.initiatePrivates()}return a.$inject=["boostInjectionPersister","$wix","$translate"],a.prototype.initiateGroups=function(){var a=this.boostInjectionPersister.getGroupServices();return a.classes||[]},a.prototype.initiatePrivates=function(){var a=this.boostInjectionPersister.getPrivateServices();return a.services||[]},a.prototype.hasServices=function(){return Object.keys(this.groups).length>0||Object.keys(this.privates).length>0},a.prototype.getClasses=function(){return this.groups},a.prototype.getPrivates=function(){return this.privates},a.prototype.getSelectedServices=function(){var a=[],b=this.selectedServicesIds;return a=this.createSelectedServices(b),a=this.addDummyServiceIfNeeded(a),0===a.length&&a.push(this.createDummyService()),a},a.prototype.createSelectedServices=function(a){var b=this,c=[];return a.services&&a.services.forEach(function(a){var d=b.getService(a.id);d&&c.push(d)}),c},a.prototype.getServices=function(){var a=[],b=this.getClasses();b.forEach(function(b){a.push(new GroupServiceVO(b))});var c=this.getPrivates();return c.forEach(function(b){a.push(new PrivateServiceVO(b))}),a},a.prototype.createDummyService=function(){var a;return a=this.$wix.isOverEditor()?this.createDummyServiceForOverEditor():this.createDummyServiceForViewer(),this.addDummyImage(a),new DummyServiceVO(a)},a.prototype.getService=function(a){return this.findInListById(this.getServices(),a)},a.prototype.findInListById=function(a,b){return a.find(function(a){return a.id===b})},a.prototype.addDummyServiceIfNeeded=function(a){return 0===a.length&&a.push(this.createDummyService()),a},a.prototype.createDummyServiceForOverEditor=function(){var a={};return a.name=this.$translate("editor-dummy-service.title"),a.duration=60,a.price=20,a.description=this.$translate("editor-dummy-service.description"),a.currency=this.$translate("editor-dummy-service.currency"),a},a.prototype.createDummyServiceForViewer=function(){var a={};return a.name=this.$translate("viewer-dummy-service.title"),a.duration=60,a.price=20,a.currency=this.$translate("editor-dummy-service.currency"),a},a.prototype.addDummyImage=function(a){a.images=[{fileName:"widget-icon.png",height:1e3,relativeUri:"600338_0d06ef278aaa44aeae7b88edec1101b3~mv2.png",width:1e3}]},a.prototype.populateGetServicesResult=function(a){a.selectedOfferings?this.selectedServicesIds={services:a.selectedOfferings}:this.selectedServicesIds={},this.groups=a.groupOfferings,this.privates=a.individualOfferings},a}();angular.module("widgetCommon").service("servicesSrv",ServicesSrv);var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ViewerServicesSrv=function(a){function b(b,c,d,e,f,g){var h=a.call(this,b,d,e)||this;return h.widgetViewerApiSrv=c,h.$rootScope=f,h.eventsConst=g,h}return __extends(b,a),b.$inject=["boostInjectionPersister","widgetViewerApiSrv","$wix","$translate","$rootScope","eventsConst"],b.prototype.gettingUpdatedServices=function(){var a=this,b=this.$wix.Utils.getCompId();return this.widgetViewerApiSrv.gettingWidgetSelectedService(b).then(function(b){return a.populateGetServicesResult(b),a.$rootScope.$emit(a.eventsConst.SERVICE_CHANGE,b),a.getSelectedServices()})},b}(ServicesSrv);angular.module("widgetCommon").service("viewerServicesSrv",ViewerServicesSrv);var WixSdkUtil=function(){function a(a,b,c,d){this.$wix=a,this.$translate=b,this.eventsConst=c,this.$q=d}return a.$inject=["$wix","$translate","eventsConst","$q"],a.prototype.getTextForModel=function(a,b){void 0===b&&(b=null);var c,d=this.$wix.Styles.getStyleParams();if(d){var e=d.fonts;e&&e[a]&&(c=e[a].cssFontFamily)}return c&&""!==c||!b||(c=this.$translate(b)),c},a.prototype.setTextForModel=function(a,b,c){this.$wix.Styles.setFontParam(a,{value:{cssFontFamily:b,fontParam:!1}},c)},a.prototype.getPresetFontByType=function(a){for(var b=this.$wix.Styles.getSiteTextPresets(),c=[],d=this.$wix.Styles.getEditorFonts(),e=0;e<d.length;e++)c=c.concat(d[e].fonts);for(var f=b[a],g=0;g<c.length;g++)if(f.fontFamily===c[g].fontFamily)return{value:{cssFontFamily:c[g].cssFontFamily,family:c[g].family,fontParam:!0,index:g,value:c[g].family}}},a.prototype.bindModelToFakeParam=function(a,b,c){var d=this,e=this.getTextForModel(a);if("Checkbox"===b)this.$wix.UI.set(a,"false"!==e);else if(e){var f=this.getTextForModel(a+"_index");this.$wix.UI.set(a,{value:e,index:f})}this.$wix.UI.onChange(a,function(e){"Checkbox"===b?d.setTextForModel(a,e+"",!1):(d.setTextForModel(a,e.value,!1),d.setTextForModel(a+"_index",e.index,!1));var f=c||d.eventsConst.PREVIEW_UPDATE;d.$wix.Settings.triggerSettingsUpdatedEvent(f,d.$wix.Utils.getOrigCompId())})},a.prototype.resetHeight=function(){var a=this.$wix.Utils.getViewMode();("site"===a||"preview"===a)&&this.$wix.getBoundingRectAndOffsets(function(a){this.$wix.scrollTo(0,a.offsets.y)})},a.prototype.getStyleParams=function(){var a=this.$q.defer(),b=this.$wix.Utils.getViewMode();return"standalone"===b?a.resolve({}):this.$wix.Styles.getStyleParams(function(b){a.resolve(b)}),a.promise},a}();angular.module("wixSdkUtilInternal").service("wixSdkUtil",WixSdkUtil);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.OPEN_BACK_OFFICE="settings-events.openBackOffice",this.INITIALIZE_SDK_CREATOR="settings-events.initializeSdkCreator"}return a}();a.SettingsEvents=b,angular.module("schedulerWidgetAppConstants").constant("eventsConst",{GLOBAL_CONTENT_CHANGED:"$includeContentLoaded",PREVIEW_UPDATE:"preview-update",OWNER_OVER_EDITOR_CHANGE:"scheduler-owner-update",LANGUAGE_CHANGE:"language-update",LAYOUT_CHANGE:"layout-update",SERVICE_CHANGE:"service-update",CONTENT_CHANGED:"wix.scheduler.contentChanged",CONTENT_CHANGED_HEIGHT:"wix.scheduler.contentChangedHeight",INITIALIZE_SET_CONTENT:"initializeSetContent",WINDOW_RESIZE:"windowResize",GOTO_SERVICE:"gotoService"}).constant("datepickerEvents",{DATE_CHANGED:"datepicker.date-changed"}).constant("TILE_LIST_EVENTS",{TILE_SELECTED:"tile-list.service-selected",TILE_SHOW_DETAILS:"tile-list.show-details",TILE_SHOW_LIST:"tile-list.show-list"}).constant("SETTINGS_EVENTS",new b)}(b=a.constants||(a.constants={}))}(b=a.widget||(a.widget={}))}(b=a.boost||(a.boost={}))}(wix||(wix={})),function(){angular.module("schedulerWidgetAppConstants").constant("apiConst",{WIDGET_URL_PREFIX:"/_api/scheduler-server/owner/widget"})}(),angular.module("schedulerWidgetAppConstants").constant("TILE_IMAGE_SHAPE",{SQUARE:"square",ROUND:"round",NONE:"none"}).constant("TILE_IMAGE_SHAPE_INDEX",{0:"square",1:"round",2:"none"}).constant("SERVICE_TEMPLATE",{LIST_REGULAR:"angelina",LIST_LARGE:"heidi",CARDS:"bar",ANGELINA:"angelina",HEIDI:"heidi",BAR:"bar",SKIP:"skippage"}).constant("SERVICE_TEMPLATE_INDEX",{0:"heidi",1:"bar"}).constant("SERVICE_CATEGORY_LAYOUT",{HORIZONTAL:"horizontal",VERTICAL:"vertical",NONE:"none"}).constant("TILE_BUTTON_STYLE",{FULL:"full",BORDER:"border",LINK:"link"}).constant("TILE_BUTTON_STYLE_INDEX",{0:"full",1:"border",2:"link"}).constant("TILE_CARD_TEXT_ALIGNMENT",{LEFT:"left",CENTER:"center",RIGHT:"right"}).constant("TILE_CARD_TEXT_ALIGNMENT_INDEX",{0:"left",1:"center",2:"right"}).constant("MAX_ALLOWED_SERVICES",5);var StorageConst=function(){function a(){}return a}();StorageConst.WIDGET_SETTINGS_SHOWN="WIDGET_SETTINGS_SHOWN",StorageConst.DEEP_LINK="deepLink",StorageConst.SERVICE_TYPE="serviceType",StorageConst.SERVICE_ID="serviceId",angular.module("schedulerWidgetAppConstants").constant("storageConst",StorageConst);var WidgetViewerApiSrv=function(){function a(a,b,c){var d=this;this.$http=a,this.apiConst=b,this.commonApiBase=c,this.gettingWidgetSelectedService=this.commonApiBase.httpWrapper(function(a){var b=d.urlPrefix+"/services?compId="+a;return d.$http.get(b)}),this.urlPrefix=this.getUrlPrefix()}return a.$inject=["$http","apiConst","commonApiBase"],a.prototype.getUrlPrefix=function(){return this.apiConst.WIDGET_URL_PREFIX},a}();angular.module("serviceWidgetViewerInternal").service("widgetViewerApiSrv",WidgetViewerApiSrv);var ViewerApp=function(){function a(a,b,c,d,e,f,g){this.$wix=a,this.$window=b,this.viewerServicesSrv=c,this.settingsPersistence=d,this.widgetViewerApiSrv=f,this.$rootScope=g,this.services=this.viewerServicesSrv.getSelectedServices(),this.settings=this.settingsPersistence.getDefaultSettings(),e.sendViewerOpened(this.services[0].id),this.updateSettings(),this.setOverEditorListener(),this.setBodyDeviceClass()}return a.$inject=["$wix","$window","viewerServicesSrv","settingsPersistence","widgetBILogger","widgetViewerApiSrv","$rootScope"],a.prototype.setBodyDeviceClass=function(){var a=this.$wix.Utils.getDeviceType().toLowerCase();$("body").addClass("widget-viewer-"+a)},a.prototype.setOverEditorListener=function(){var a=this;this.$wix.isOverEditor()&&this.$wix.addEventListener(this.$wix.Events.SETTINGS_UPDATED,function(b){switch(b.event){case SettingsToViewerNotifier.LAYOUT_CHANGE:a.onLayoutChanged(b);break;case SettingsToViewerNotifier.SERVICE_CHANGE:a.onSelectedServiceChanged(b);break;case SettingsToViewerNotifier.BACKOFFICE_CLOSED:a.onBackofficeClosed(b)}})},a.prototype.onLayoutChanged=function(a){this.updateSettings()},a.prototype.onSelectedServiceChanged=function(a){var b=this;this.viewerServicesSrv.gettingUpdatedServices().then(function(a){b.services=a,b.$rootScope.$applyAsync()})},a.prototype.onBackofficeClosed=function(a){this.$window.location.reload()},a.prototype.updateSettings=function(){var a=this;this.settingsPersistence.gettingSettings().then(function(b){a.settings=b})},a}();angular.module("serviceWidgetViewerInternal").controller("ViewerApp",ViewerApp).component("widgetViewerApp",{templateUrl:"modules/viewer-app/widget-viewer-app.preload.html",controller:ViewerApp});var SettingsToViewerNotifier=function(){function a(a,b,c,d){this.$wix=a,this.$rootScope=b,this.eventsConst=c,this.$timeout=d}return a.$inject=["$wix","$rootScope","eventsConst","$timeout"],a.prototype.notifyLayoutChange=function(){this.update(a.LAYOUT_CHANGE)},a.prototype.notifyServiceChange=function(b){this.update(a.SERVICE_CHANGE)},a.prototype.notifyBackofficeClosed=function(){this.update(a.BACKOFFICE_CLOSED)},a.prototype.update=function(b){var c=this;return b!==a.SERVICE_CHANGE?this.$wix.Settings.triggerSettingsUpdatedEvent({event:b},this.$wix.Utils.getOrigCompId()):(this.$timeout.cancel(this.timeout),void(this.timeout=this.$timeout(function(){return c.$wix.Settings.triggerSettingsUpdatedEvent({event:b},c.$wix.Utils.getOrigCompId())},1e3)))},a}();SettingsToViewerNotifier.LAYOUT_CHANGE="layout-change",SettingsToViewerNotifier.SERVICE_CHANGE="service-change",SettingsToViewerNotifier.BACKOFFICE_CLOSED="backoffice-closed",angular.module("widgetCommon").service("settingsToViewerNotifier",SettingsToViewerNotifier);var wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.WIDGET_SETTINGS_TAB_MENU_CLICK={evid:112},this.WIDGET_SETTINGS_LAYOUT_SELECTION={evid:113},this.WIDGET_SETTINGS_ADD_NEW_SERVICE={evid:115},this.WIDGET_SETTINGS_IMAGE_TYPE_SELECTION={evid:126},this.WIDGET_SETTINGS_TEXT_ALIGNMENT_SELECTION={evid:127},this.WIDGET_SETTINGS_BACKOFFICE_OPENED={evid:133},this.WIDGET_SETTINGS_UPGRADE_CLICKED={evid:156},this.WIDGET_SETTINGS_OPENED={evid:160},this.WIDGET_SETTINGS_BUTTON_TEXT_CHANGE={evid:166},this.WIDGET_SETTINGS_STYLE_CHANGED={evid:167},this.WIDGET_SETTINGS_CHOOSE_SERVICE={evid:195},this.WIDGET_SETTINGS_ADD_EDIT_SERVICE={evid:196},this.WIDGET_SETTINGS_BUTTON_STYLE_SELECTION={evid:197},this.WIDGET_SETTINGS_SHOW_SERVICE_INFO_CHANGE={evid:202}}return a}();a.WidgetSettingsEvents=b;var c=function(){function a(){this.WIDGET_VIEWER_CARD_CLICK={evid:501},this.WIDGET_VIEWER_PAGE_LOADED={evid:540}}return a}();a.WidgetViewerEvents=c,angular.module("schedulerWidgetAppConstants").constant("appSettingsEventMap",new b).constant("appViewerEventMap",new c)}(b=a.bi||(a.bi={}))}(b=a.widgetSettings||(a.widgetSettings={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),wix;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b,c){return a.call(this,b,c)||this}return __extends(b,a),b.$inject=["wixBiLogger","$rootScope"],b.prototype.sendTabsPosition=function(a){var b={selection:a};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_TAB_MENU_CLICK,b)},b.prototype.sendLayoutChange=function(a){var b={bar:"grid",heidi:"classic",angelina:"list"};a=b[a];var c={selection:a};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_LAYOUT_SELECTION,c)},b.prototype.sendAddingNewService=function(a,b,c){var d={location:a,num_of_service:b,type:c};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_ADD_NEW_SERVICE,d)},b.prototype.sendImageTypeSelection=function(a){var b={selection:a};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_IMAGE_TYPE_SELECTION,b)},b.prototype.sendTextAlignmentSelection=function(a){var b="widget",c={referralInfo:b,selection:a};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_TEXT_ALIGNMENT_SELECTION,c)},b.prototype.sendOpenUpgrade=function(){var a={referral_info:"widget"};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_UPGRADE_CLICKED,a)},b.prototype.sendSettingsOpened=function(a){var b={referralInfo:"widget",isFirst:a};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_OPENED,b)},b.prototype.sendOpenBackOffice=function(){var a={};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_BACKOFFICE_OPENED,a)},b.prototype.sendStyleChange=function(a,b){var c="widget",d={element:a,parameter:b,referralInfo:c};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_STYLE_CHANGED,d)},b.prototype.sendChoosingService=function(a){var b={PRIVATE:"ind",GROUP:"groups"},c={type:b[a]};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_CHOOSE_SERVICE,c)},b.prototype.sendEditAddService=function(){var a={};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_ADD_EDIT_SERVICE,a)},b.prototype.sendButtonStyleSelection=function(a){var b={full:"frame_colored_background",border:"frame",none:"no_frame"},c="widget",d={referralInfo:c,selection:b[a]};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_BUTTON_STYLE_SELECTION,d)},b.prototype.sendButtonTextChange=function(a){var b="widget",c={element:a,referralInfo:b};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_BUTTON_TEXT_CHANGE,c)},b.prototype.sendShowServiceInfoChange=function(a,b){var c={info:a,isShow:b};this.log(this.wixBiLogger.events.WIDGET_SETTINGS_SHOW_SERVICE_INFO_CHANGE,c)},b.prototype.sendViewerOpened=function(a){if(!c.isOverEditor()){var b={serviceId:a};this.log(this.wixBiLogger.events.WIDGET_VIEWER_PAGE_LOADED,b)}},b.prototype.sendCardClick=function(a,b){var c={PRIVATE:"ind",GROUP:"class"},d="widget",e={referralInfo:d,service_id:a,type:c[b]};this.log(this.wixBiLogger.events.WIDGET_VIEWER_CARD_CLICK,e)},b.prototype.log=function(a,b){void 0===b&&(b={}),this.wixBiLogger.log(a,b)},b}(BILogger);a.WidgetBILogger=b;var c=function(){function a(){}return a.getUserId=function(){var a="";try{a=Wix.Utils.getInstanceValue("uid"),a&&null!==a||(a=Wix.Utils.getInstanceValue("aid"))}catch(b){a=""}return a},a.isOwner=function(){var a;try{a="OWNER"===Wix.Utils.getPermissions()}catch(b){a=!1}return a},a.getBiToken=function(){var a="";try{a=Wix.Utils.getInstanceValue("biToken")}catch(b){a=""}return a},a.isOverEditor=function(){var a=!1;try{a=Wix.Utils.isOverEditor()}catch(b){a=!1}return a},a.getBusinessId=function(){var a="";try{a=Wix.Utils.getInstanceId()}catch(b){a=""}return a},a}();a.WidgetBILoggerUtils=c;var d=function(){function a(a){this.wixBiLoggerProvider=a}return a.$inject=["wixBiLoggerProvider"],a.prototype.prepareConfigParams=function(){var a,b,d="",e="",f="";return d=c.getUserId(),a=c.isOwner(),e=c.getBiToken(),b=c.isOverEditor(),f=c.getBusinessId(),{uid:d,biToken:e,businessId:f,isOwner:a,isOverEditor:b}},a.prototype.setWixBiLoggerConfigInSettings=function(a,b){var c=this.prepareConfigParams(),d=c.biToken,e=void 0===d?"":d,f=c.businessId,g=void 0===f?"":f;this.wixBiLoggerProvider.setConfig({eventMap:a,defaultEventArgs:{src:16,adapter:b,businessId:g,biToken:e}})},a.prototype.setWixBiLoggerConfigInViewer=function(a,b){var c=this.prepareConfigParams(),d=c.biToken,e=void 0===d?"":d,f=c.businessId,g=void 0===f?"":f,h=c.isOwner,i=c.isOverEditor,j=c.uid,k=void 0===j?"":j;this.wixBiLoggerProvider.setConfig({eventMap:a,defaultEventArgs:{src:16,adapter:b,businessId:g,biToken:e,is_over_editor:i,is_owner:h,visitor_id:k}})},a.prototype.$get=function(a){return a.instantiate(b,{provider:this})},a.prototype.$get.$inject=["$injector"],a}();a.WidgetBILoggerProvider=d,angular.module("widgetBiLogger").provider("widgetBILogger",d)}(b=a.bi||(a.bi={}))}(b=a.widgetSettings||(a.widgetSettings={}))}(b=a.boost||(a.boost={}))}(wix||(wix={}));var ServiceList=function(){function a(a,b,c,d,e,f){this.$window=a,this.$rootScope=b,this.eventsConst=c,this.$timeout=d,this.$wix=e,this.experimentsEnabler=f,this.currentServiceIndex=0,this.isPrevClicked=!1,this.isNextClicked=!1,this.setWindowResizeListener(),this.device=e.Utils.getDeviceType().toLowerCase()}return a.$inject=["$window","$rootScope","eventsConst","$timeout","$wix","experimentsEnabler"],a.prototype.isMobile=function(){return"mobile"===this.device},a.prototype.setWindowResizeListener=function(){var a=this,b=angular.element(this.$window);b.bind("resize",function(){a.$rootScope.$broadcast(a.eventsConst.WINDOW_RESIZE)})},a.prototype.isToDisplayArrows=function(){return!this.isMobile()&&this.services.length>1},a.prototype.nextService=function(){var a=this;this.$timeout(function(){a.isNextClicked=!0,a.isPrevClicked=!1}),this.$timeout(function(){a.currentServiceIndex=a.getNextIndex()})},a.prototype.getNextIndex=function(){var a=this.currentServiceIndex;return a++,a%=this.services.length},a.prototype.prevService=function(){var a=this;this.$timeout(function(){a.isNextClicked=!1,a.isPrevClicked=!0}),this.$timeout(function(){a.currentServiceIndex=a.getPrevIndex()})},a.prototype.getPrevIndex=function(){var a=this.currentServiceIndex;return a--,0>a&&(a=this.services.length-1),a},a.prototype.isToShowNavigation=function(){return this.isMobile()&&this.services.length>1},a.prototype.gotoService=function(a){a!==this.currentServiceIndex&&(this.$rootScope.$broadcast(this.eventsConst.GOTO_SERVICE),a>this.currentServiceIndex?this.gotoNextService(a):this.gotoPrevService(a))},a.prototype.gotoNextService=function(a){var b=this;this.$timeout(function(){b.isNextClicked=!0,b.isPrevClicked=!1}),this.$timeout(function(){b.currentServiceIndex=a})},a.prototype.gotoPrevService=function(a){var b=this;this.$timeout(function(){b.isNextClicked=!1,b.isPrevClicked=!0}),this.$timeout(function(){b.currentServiceIndex=a})},a.prototype.onKeyPressRightArrow=function(a){var b=a.which;if(this.experimentsEnabler.isVisitorAccessibilityEnabled()){var c=13,d=32;(c===b||d===b)&&this.nextService()}},a.prototype.onKeyPressLeftArrow=function(a){var b=a.which;if(this.experimentsEnabler.isVisitorAccessibilityEnabled()){var c=13,d=32;(c===b||d===b)&&this.prevService()}},a}();angular.module("serviceWidgetViewerInternal").component("boostServiceList",{templateUrl:"modules/service-list/service-list.preload.html",controller:ServiceList,bindings:{services:"=",settings:"="}}).animation(".slide-animation",function(){return{}});var ServiceTile=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this.$translate=a,this.widgetNavigateSrv=b,this.commonServices=c,this.TILE_IMAGE_SHAPE=d,this.TILE_BUTTON_STYLE=e,this.TILE_CARD_TEXT_ALIGNMENT=f,this.$wix=g,this.widgetBILogger=h,this.activeFeatures=i,this.servicesSrv=j,this.libs=k,this.$window=l,this.$timeout=m,this.$rootScope=n,this.eventsConst=o,this.experimentsEnabler=p,this.$element=q,this.hover=!1,this.device="desktop",this.isOverlayVisible=!1,this.showCouldNotNavigateMessage=!1}return a.$inject=["$translate","widgetNavigateSrv","commonServices","TILE_IMAGE_SHAPE","TILE_BUTTON_STYLE","TILE_CARD_TEXT_ALIGNMENT","$wix","widgetBILogger","activeFeatures","servicesSrv","libs","$window","$timeout","$rootScope","eventsConst","experimentsEnabler","$element"],a.prototype.$onInit=function(a){var b=this;this.service.type===Service.GROUP&&this.initializeGroup(),this.device=this.$wix.Utils.getDeviceType().toLowerCase(),this.isImageVisible()&&this.setImageUrl(),this.setWindowResizeListener(),this.setGotoServiceListener(),this.experimentsEnabler.isVisitorAccessibilityEnabled()&&this.$timeout(function(){var a=b.$element.find(".mCustomScrollBox");a.on("focus",function(){a.mouseover(),a.addClass("focus")}),a.on("focusout",function(){a.mouseleave(),a.removeClass("focus")})},100)},a.prototype.isShowOverlay=function(){return this.isDummyService()?!1:this.displayDescription},a.prototype.setOverlayVisible=function(a){this.isOverlayVisible=a},Object.defineProperty(a.prototype,"displayButton",{get:function(){return this.displayServiceDetails()},enumerable:!0,configurable:!0}),
Object.defineProperty(a.prototype,"displayServiceName",{get:function(){return this.settings.displayServiceName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"displayServiceDuration",{get:function(){return this.displayServiceDetails()&&this.settings.displayServiceDuration},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"displayServicePrice",{get:function(){return this.displayServiceDetails()&&this.settings.displayServicePrice},enumerable:!0,configurable:!0}),a.prototype.isHideImage=function(){return this.isRoundImage()&&this.hover&&this.isShowOverlay()},Object.defineProperty(a.prototype,"displayDescription",{get:function(){return this.displayServiceDetails()?this.service.description&&this.settings.displayServiceDescription:!1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.service.description},enumerable:!0,configurable:!0}),a.prototype.isSquareImage=function(){return this.settings.imageType===this.TILE_IMAGE_SHAPE.SQUARE},a.prototype.isRoundImage=function(){return this.settings.imageType===this.TILE_IMAGE_SHAPE.ROUND},a.prototype.isImageVisible=function(){return this.settings.imageType!==this.TILE_IMAGE_SHAPE.NONE},Object.defineProperty(a.prototype,"buttonText",{get:function(){return this.settings.buttonText?this.settings.buttonText:this.$translate("settings.design.button.book-it")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"displayDays",{get:function(){return this.service.type===Service.GROUP&&this.displayServiceDetails()&&this.settings.displayServiceDays},enumerable:!0,configurable:!0}),a.prototype.getDays=function(){return this.days},a.prototype.setDays=function(a){this.days=a},a.prototype.getFullDays=function(){return this.fullDays},a.prototype.setFullDays=function(a){this.fullDays=a},Object.defineProperty(a.prototype,"serviceName",{get:function(){return this.service.name},enumerable:!0,configurable:!0}),a.prototype.setImageUrl=function(){this.imageUrl=this.commonServices.getImageUrl(this.service.images,{width:960,height:960})},Object.defineProperty(a.prototype,"displaySeparator",{get:function(){return this.isRoundImage()||!this.isImageVisible()},enumerable:!0,configurable:!0}),a.prototype.initializeGroup=function(){this.setDays(this.service.getTranslatedActiveDays(this.$translate)),this.setFullDays(this.service.getTranslatedActiveDays(this.$translate,!0))},a.prototype.displayServiceDetails=function(){return this.isDummyService()?this.$wix.isOverEditor():!0},a.prototype.onServiceClick=function(){this.isDummyService()||(this.widgetBILogger.sendCardClick(this.service.id,this.service.type),this.couldBeNavigate()?this.goToService():this.showCouldNotNavigateMessage=!0)},a.prototype.goToService=function(){this.service.type===Service.GROUP?this.widgetNavigateSrv.navigateToGroup(this.service):this.widgetNavigateSrv.navigateToIndividual(this.service)},a.prototype.isDummyService=function(){return this.service.type===Service.DUMMY},a.prototype.isButtonStyleLink=function(){return this.settings.buttonStyle===this.TILE_BUTTON_STYLE.LINK},a.prototype.isButtonStyleBorder=function(){return this.settings.buttonStyle===this.TILE_BUTTON_STYLE.BORDER},a.prototype.isButtonStyleFull=function(){return this.settings.buttonStyle===this.TILE_BUTTON_STYLE.FULL},a.prototype.isTextAlignmentLeft=function(){return this.settings.cardTextAlignment===this.TILE_CARD_TEXT_ALIGNMENT.LEFT},a.prototype.isTextAlignmentCenter=function(){return this.settings.cardTextAlignment===this.TILE_CARD_TEXT_ALIGNMENT.CENTER},a.prototype.isTextAlignmentRight=function(){return this.settings.cardTextAlignment===this.TILE_CARD_TEXT_ALIGNMENT.RIGHT},a.prototype.couldBeNavigate=function(){return this.service.type===Service.PRIVATE||this.activeFeatures.groups||this.$wix.isOverEditor()},a.prototype.isToDisplayServiceNameWithOverlayClick=function(){return this.displayServiceName&&this.isImageVisible()&&this.displayDescription&&!this.isOverlayVisible},a.prototype.isToDisplayServiceNameWithoutOverlayClick=function(){return this.displayServiceName&&(!this.isImageVisible()||!this.displayDescription||this.isOverlayVisible)},a.prototype.setWindowResizeListener=function(){var a=this;this.$rootScope.$on(this.eventsConst.WINDOW_RESIZE,function(){a.setImageUrl()})},a.prototype.setGotoServiceListener=function(){var a=this;this.$rootScope.$on(this.eventsConst.GOTO_SERVICE,function(){a.setOverlayVisible(!1)})},a}();angular.module("serviceWidgetViewerInternal").component("boostServiceTile",{templateUrl:"modules/service-list/service-tile/service-tile.preload.html",controller:ServiceTile,bindings:{service:"=",settings:"="}});var ResponsiveRoundImage=function(){function a(a,b,c,d){this.$element=a,this.$rootScope=b,this.eventsConst=c,this.$document=d,this.init()}return a.$inject=["$element","$rootScope","eventsConst","$document"],a.prototype.init=function(){this.setWindowResizeListener(),this.onWindowResize()},a.prototype.onWindowResize=function(){var b=Math.min(this.$document.height(),this.$document.width())*a.PERCENTAGE_OF_PARENT;this.$element.height(b),this.$element.width(b)},a.prototype.setWindowResizeListener=function(){var a=this;this.$rootScope.$on(this.eventsConst.WINDOW_RESIZE,function(){a.onWindowResize()})},a}();ResponsiveRoundImage.PERCENTAGE_OF_PARENT=.75,angular.module("serviceWidgetViewerInternal").directive("boostResponsiveRoundImage",["$document",function(a){return{templateUrl:"modules/service-list/service-tile/responsive-rounded-image/responsive-rounded-image.preload.html",controller:ResponsiveRoundImage,controllerAs:"$ctrl",replace:!0,restrict:"E",bindToController:!0,scope:{imageUrl:"="}}}]);